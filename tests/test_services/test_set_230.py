""" Code is generated by ucloud-model, DO NOT EDIT IT. """

import pytest
import logging

from ucloud.core import exc
from ucloud.testing import env, funcs, op, utest

logger = logging.getLogger(__name__)


scenario = utest.Scenario(230)


@pytest.mark.skipif(env.is_ut(), reason=env.get_skip_reason())
def test_set_230(client: utest.Client, variables: dict):
    scenario.initial(variables)

    scenario.variables["sbw_name"] = "sbw_api_auto"
    scenario.variables["sbw_chargetype"] = "Month"
    scenario.variables["sbw_bw"] = 20
    scenario.variables["resize_bw"] = 22
    scenario.variables["Region"] = "cn-bj2"
    scenario.variables["eip_operatorname"] = "Bgp"
    scenario.variables["eip_bw"] = 2

    scenario.run(client)


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [("str_eq", "RetCode", 0)],
    action="AllocateShareBandwidth",
)
def allocate_share_bandwidth_00(client: utest.Client, variables: dict):
    d = {
        "ShareBandwidth": variables.get("sbw_bw"),
        "Region": variables.get("Region"),
        "Name": variables.get("sbw_name"),
        "ChargeType": variables.get("sbw_chargetype"),
    }

    try:
        resp = client.unet().allocate_share_bandwidth(d)
    except exc.RetCodeException as e:
        resp = e.json()

    variables["sbw_id"] = utest.value_at_path(resp, "ShareBandwidthId")
    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [("str_eq", "RetCode", 0)],
    action="AllocateEIP",
)
def allocate_eip_01(client: utest.Client, variables: dict):
    d = {
        "Region": variables.get("Region"),
        "PayMode": "Traffic",
        "OperatorName": variables.get("eip_operatorname"),
        "Name": "eip_auto",
        "ChargeType": "Month",
        "Bandwidth": variables.get("eip_bw"),
    }

    try:
        resp = client.unet().allocate_eip(d)
    except exc.RetCodeException as e:
        resp = e.json()

    variables["eip_id"] = utest.value_at_path(resp, "EIPSet.0.EIPId")
    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=30,
    fast_fail=False,
    validators=lambda variables: [("str_eq", "RetCode", 0)],
    action="AssociateEIPWithShareBandwidth",
)
def associate_eip_with_share_bandwidth_02(
    client: utest.Client, variables: dict
):
    d = {
        "ShareBandwidthId": variables.get("sbw_id"),
        "Region": variables.get("Region"),
        "EIPIds": [variables.get("eip_id")],
    }

    try:
        resp = client.unet().associate_eip_with_share_bandwidth(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [
        ("str_eq", "RetCode", 0),
        ("gt", "TotalPrice", 0),
    ],
    action="DescribeShareBandwidthPrice",
)
def describe_share_bandwidth_price_03(client: utest.Client, variables: dict):
    d = {
        "ShareBandwidth": variables.get("sbw_bw"),
        "Region": variables.get("Region"),
        "Quantity": 1,
        "ChargeType": variables.get("sbw_chargetype"),
    }

    try:
        resp = client.invoke("DescribeShareBandwidthPrice", d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [
        ("str_eq", "RetCode", 0),
        ("str_eq", "DataSet.0.ShareBandwidthId", variables.get("sbw_id")),
        ("str_eq", "DataSet.0.ShareBandwidth", variables.get("sbw_bw")),
        ("str_eq", "DataSet.0.ChargeType", variables.get("sbw_chargetype")),
        ("str_eq", "DataSet.0.Name", variables.get("sbw_name")),
        ("str_eq", "TotalCount", 1),
        ("str_eq", "DataSet.0.EIPSet.0.EIPId", variables.get("eip_id")),
    ],
    action="DescribeShareBandwidth",
)
def describe_share_bandwidth_04(client: utest.Client, variables: dict):
    d = {
        "ShareBandwidthIds": [variables.get("sbw_id")],
        "Region": variables.get("Region"),
    }

    try:
        resp = client.unet().describe_share_bandwidth(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [("str_eq", "RetCode", 0)],
    action="ResizeShareBandwidth",
)
def resize_share_bandwidth_05(client: utest.Client, variables: dict):
    d = {
        "ShareBandwidthId": variables.get("sbw_id"),
        "ShareBandwidth": variables.get("resize_bw"),
        "Region": variables.get("Region"),
    }

    try:
        resp = client.unet().resize_share_bandwidth(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [
        ("str_eq", "RetCode", 0),
        ("str_eq", "DataSet.0.ShareBandwidth", variables.get("resize_bw")),
    ],
    action="DescribeShareBandwidth",
)
def describe_share_bandwidth_06(client: utest.Client, variables: dict):
    d = {
        "ShareBandwidthIds": [variables.get("sbw_id")],
        "Region": variables.get("Region"),
    }

    try:
        resp = client.unet().describe_share_bandwidth(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=3,
    retry_interval=1,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [
        ("str_eq", "RetCode", 0),
        ("str_eq", "EIPSet.0.BandwidthType", 1),
        ("str_eq", "EIPSet.0.PayMode", "ShareBandwidth"),
    ],
    action="DescribeEIP",
)
def describe_eip_07(client: utest.Client, variables: dict):
    d = {
        "Region": variables.get("Region"),
        "Offset": 0,
        "Limit": 100,
        "EIPIds": [variables.get("eip_id")],
    }

    try:
        resp = client.unet().describe_eip(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=5,
    fast_fail=False,
    validators=lambda variables: [("str_eq", "RetCode", 0)],
    action="DisassociateEIPWithShareBandwidth",
)
def disassociate_eip_with_share_bandwidth_08(
    client: utest.Client, variables: dict
):
    d = {
        "ShareBandwidthId": variables.get("sbw_id"),
        "Region": variables.get("Region"),
        "EIPIds": [variables.get("eip_id")],
        "Bandwidth": variables.get("eip_bw"),
    }

    try:
        resp = client.unet().disassociate_eip_with_share_bandwidth(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=3,
    retry_interval=10,
    startup_delay=10,
    fast_fail=False,
    validators=lambda variables: [
        ("str_eq", "RetCode", 0),
        ("str_eq", "EIPSet.0.BandwidthType", 0),
        ("str_eq", "EIPSet.0.PayMode", "Bandwidth"),
    ],
    action="DescribeEIP",
)
def describe_eip_09(client: utest.Client, variables: dict):
    d = {
        "Region": variables.get("Region"),
        "Offset": 0,
        "Limit": 100,
        "EIPIds": [variables.get("eip_id")],
    }

    try:
        resp = client.unet().describe_eip(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=3,
    retry_interval=1,
    startup_delay=0,
    fast_fail=False,
    validators=lambda variables: [
        ("str_eq", "RetCode", 0),
        ("gt", "Info.BwOutSum", 0),
        ("gt", "Info.BwOutShareSum", 0),
        ("gt", "Info.BwOutAll", 0),
    ],
    action="GetBandwidthSum",
)
def get_bandwidth_sum_10(client: utest.Client, variables: dict):
    d = {"Region": variables.get("Region")}

    try:
        resp = client.invoke("GetBandwidthSum", d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=0,
    fast_fail=False,
    action="ReleaseEIP",
)
def release_eip_11(client: utest.Client, variables: dict):
    d = {"Region": variables.get("Region"), "EIPId": variables.get("eip_id")}

    try:
        resp = client.unet().release_eip(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp


@scenario.step(
    max_retries=10,
    retry_interval=10,
    startup_delay=3,
    fast_fail=False,
    validators=lambda variables: [("str_eq", "RetCode", 0)],
    action="ReleaseShareBandwidth",
)
def release_share_bandwidth_12(client: utest.Client, variables: dict):
    d = {
        "ShareBandwidthId": variables.get("sbw_id"),
        "Region": variables.get("Region"),
        "EIPBandwidth": 2,
    }

    try:
        resp = client.unet().release_share_bandwidth(d)
    except exc.RetCodeException as e:
        resp = e.json()

    return resp
